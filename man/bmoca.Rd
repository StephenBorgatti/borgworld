% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/b_moca.R
\name{bmoca}
\alias{bmoca}
\title{Measures of Cluster Adequacy (MOCA)}
\usage{
bmoca(proximity_matrix, partitions, type)
}
\arguments{
\item{proximity_matrix}{A square matrix of proximities (either similarities or dissimilarities).}

\item{partitions}{A matrix where each column represents a partition (cluster assignment).
Rows correspond to items and values indicate cluster membership.
Can also be a data frame which will be converted to a matrix.}

\item{type}{Character string specifying the type of proximity measure;
"similarities" or "dissimilarities" (can be abbreviated to "sim" or "diss").
This parameter is required with no default to ensure explicit specification.}
}
\value{
A data frame with rows corresponding to partitions and columns:
\item{n_clusters}{Number of clusters in each partition}
\item{Corr}{Correlation between proximity and same-cluster matrices.
For dissimilarities: negative correlation expected (multiplied by -1 so higher is better).
Higher values indicate better cluster adequacy.
Returns NA when all items are in a single cluster.}
\item{Gamma}{Hubert's Gamma statistic. Normalized sum of products between proximity
and same-cluster matrices. Different from Corr as it uses products rather than correlation.}
\item{Modularity}{Newman's modularity for weighted networks. For dissimilarities,
distances are converted to similarities using 1/(1+dist).
Measures how much the clustering exceeds random expectation.}
\item{Silhouette}{Average silhouette width across all items. Ranges from -1 to 1,
where higher values indicate better-defined clusters.}
}
\description{
Calculate measures of cluster adequacy for evaluating how well a set of partitions
fits a proximity matrix. Implements multiple measures including correlation,
modularity, Hubert's Gamma, and average silhouette width.
}
\details{
The measures calculated are:

\itemize{
\item \strong{Corr}: Correlation between proximity matrix and binary same-cluster matrix
\item \strong{Gamma}: Hubert's Gamma - normalized sum of products (not correlation)
\item \strong{Modularity}: Newman's modularity Q, treating proximity as a weighted network
\item \strong{Silhouette}: Average of individual silhouette values s(i)
}

For dissimilarity matrices, correlations are multiplied by -1 and distances are
converted to similarities for modularity using 1/(1+dist).

When all items are in a single cluster, correlation-based measures return NA.
}
\examples{
# Example with dissimilarities - note type is required
dissim <- matrix(c(0, 1, 4, 5,
                   1, 0, 3, 4,
                   4, 3, 0, 1,
                   5, 4, 1, 0), nrow = 4)

# Create two partitions
partitions <- matrix(c(1, 1, 2, 2,  # First partition: two clusters
                       1, 2, 3, 4), # Second partition: four clusters
                     nrow = 4, ncol = 2)
colnames(partitions) <- c("P1", "P2")

# Calculate measures of cluster adequacy - type is required
bmoca(dissim, partitions, type = "diss")

}
\seealso{
\code{\link{bhiclus}} which automatically calls bmoca on its partition table
}
